# 買賣盤失衡標記功能啟用說明

## 📅 啟用時間
2025-10-23

---

## ✅ 已完成功能

### 1. 信號形狀更新

| 信號類型 | 舊形狀 | 新形狀 | 顏色 | 視覺效果 |
|---------|--------|--------|------|----------|
| **多頭信號** | 小圓點 | **正三角形 ▲** | 🔴 紅色 | 明確向上標記 |
| **空頭信號** | 小圓點 | **倒三角形 ▼** | 🟢 綠色 | 明確向下標記 |
| **買盤失衡** | - | 圓形 ● | 🟠 橙色 | 買盤湧入警示 |
| **賣盤失衡** | - | 圓形 ● | 🟣 紫色 | 賣壓警示 |

### 2. 買賣盤失衡自動標記

系統現在會**自動監測**最近 60 筆交易的買賣盤失衡狀態，並在K線圖上標記：

#### 觸發條件

```
買賣盤失衡度 = (買方主動筆數 - 賣方主動筆數) / 總筆數
```

| 失衡度 | 標記類型 | 顏色 | 市場含義 |
|--------|---------|------|----------|
| **> 0.25** | 🟠 買盤失衡 | 橙色 | 積極買盤湧入，看多情緒強烈 |
| **< -0.25** | 🟣 賣盤失衡 | 紫色 | 恐慌賣壓出現，看空情緒強烈 |
| -0.25 ~ 0.25 | 無標記 | - | 市場買賣力道相對均衡 |

---

## 🎯 使用說明

### 如何解讀買賣盤失衡

#### 買盤失衡（橙色圓點 🟠）
- **出現時機**：當最近 60 筆交易中，買方主動成交的筆數遠多於賣方
- **市場狀態**：積極買盤湧入，市場情緒偏多
- **交易含義**：投資人願意以更高價格（賣一價）成交，顯示強烈買入意願
- **策略參考**：
  - 可能是短期拉升的信號
  - 結合價格走勢，若同時創新高，多頭力道更強
  - 注意是否為誘多或主力出貨

#### 賣盤失衡（紫色圓點 🟣）
- **出現時機**：當最近 60 筆交易中，賣方主動成交的筆數遠多於買方
- **市場狀態**：恐慌賣壓出現，市場情緒偏空
- **交易含義**：投資人願意以更低價格（買一價）成交，顯示急於出脫
- **策略參考**：
  - 可能是短期下殺的信號
  - 結合價格走勢，若同時創新低，空頭力道更強
  - 注意是否為誘空或主力吸籌

---

## 📊 信號組合解讀

### 多頭確認組合
```
🔴 多頭信號 (正三角形) + 🟠 買盤失衡 (圓點) = 強烈做多信號
```
- 內外盤連續偏多 + 價格創新高 + 買方主動積極
- 三重確認，多頭力道強勁

### 空頭確認組合
```
🟢 空頭信號 (倒三角形) + 🟣 賣盤失衡 (圓點) = 強烈做空信號
```
- 內外盤連續偏空 + 價格創新低 + 賣方主動急售
- 三重確認，空頭力道強勁

### 盤整反轉信號
```
🟣 賣盤失衡 -> 價格不跌 -> 🟠 買盤失衡 = 可能止跌反彈
🟠 買盤失衡 -> 價格不漲 -> 🟣 賣盤失衡 = 可能見頂回落
```

---

## 🔧 技術細節

### 實作位置
- **檔案**：`MainView.java`
- **方法**：`updatePriceChart()`
- **行數**：第 2573-2607 行

### 關鍵參數
| 參數 | 數值 | 說明 |
|-----|------|------|
| 監測窗口 | 60 筆交易 | 取最近 60 筆交易計算失衡度 |
| 買盤失衡閾值 | > 0.25 | 買方主動筆數占比超過 62.5% |
| 賣盤失衡閾值 | < -0.25 | 賣方主動筆數占比超過 62.5% |
| 標記點上限 | 100 個 | 避免圖表過於擁擠 |

### 去重機制
- 同一時間點（K線週期）只保留一個標記
- 如果該時間點已有標記，會更新價格位置
- 避免重複標記造成視覺混亂

---

## 📈 信號指示器面板

K線圖下方的信號指示器面板會即時顯示所有信號的累計數量：

```
▲ 多頭信號: 15   ▼ 空頭信號: 8   ● 大買單: 23   ● 大賣單: 19   ↑ 買盤失衡: 12   ↓ 賣盤失衡: 7
```

- **即時更新**：每次新增標記時自動更新計數
- **顏色對應**：符號顏色與圖表上的標記顏色一致
- **快速總覽**：一眼掌握市場多空力道分布

---

## ⚠️ 注意事項

### 1. 失衡不等於趨勢
- 買賣盤失衡反映**短期情緒**，不代表長期趨勢
- 需結合價格走勢、成交量、主力動向綜合判斷

### 2. 假突破風險
- 主力可能利用失衡製造假突破誘多/誘空
- 建議搭配其他技術指標（如 MACD、布林帶）確認

### 3. 市場環境影響
- 盤整期間：失衡信號較多但可靠性降低
- 趨勢期間：失衡信號與趨勢方向一致時可靠性較高

### 4. 標記點數量限制
- 系統最多保留 100 個失衡標記點
- 如果超過限制，會自動刪除最早的標記
- 避免長時間運行導致圖表過於擁擠

---

## 🎓 實戰範例

### 範例 1：多頭突破
```
時間：10:30
價格：100.25（創近期新高）
買賣盤失衡度：+0.32（買盤失衡）
內外盤比：外盤 68%

圖表顯示：
- 🔴 多頭信號（正三角形）
- 🟠 買盤失衡（橙色圓點）

解讀：強烈做多信號，可考慮順勢追多
```

### 範例 2：空頭破位
```
時間：14:15
價格：98.50（創近期新低）
買賣盤失衡度：-0.45（賣盤失衡）
內外盤比：內盤 72%

圖表顯示：
- 🟢 空頭信號（倒三角形）
- 🟣 賣盤失衡（紫色圓點）

解讀：強烈做空信號，可考慮順勢放空或減倉
```

### 範例 3：假突破陷阱
```
時間：11:00
價格：102.00（突破前高）
買賣盤失衡度：+0.28（買盤失衡）
後續發展：價格快速回落至 100.50

分析：
- 買盤失衡出現，但後續無法維持
- 可能是主力誘多出貨
- 需搭配成交量判斷真假突破
```

---

## 📚 相關文件

- **詳細說明**：`SIGNAL_SHAPES_AND_IMBALANCE.md`
- **顏色規範**：`COLOR_FIX_RED_UP_GREEN_DOWN.md`
- **信號面板**：`SIGNAL_INDICATOR_PANEL.md`

---

## 🎉 總結

✅ **多頭信號**：紅色正三角形 ▲  
✅ **空頭信號**：綠色倒三角形 ▼  
✅ **買盤失衡**：橙色圓點 🟠（自動標記）  
✅ **賣盤失衡**：紫色圓點 🟣（自動標記）  
✅ **信號面板**：即時顯示所有信號計數  

所有功能已全面啟用，祝您交易順利！

---

**文件版本：** 1.0  
**最後更新：** 2025-10-23

