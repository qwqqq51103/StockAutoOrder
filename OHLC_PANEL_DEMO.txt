╔════════════════════════════════════════════════════════════════════════════════╗
║                    TradingView 風格 K 線圖 - OHLC 面板示意圖                    ║
╚════════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────────────────────┐
│ ┌────────────────────────────────────────────┐                               │
│ │  14:35:20  +2.35 (+0.45%)  ← 綠色顯示     │   ← OHLC 信息面板（左上角）    │
│ │  O: 520.00  H: 525.50  L: 518.00  C: 522.35│                               │
│ └────────────────────────────────────────────┘                               │
│                                                                               │
│  525┤                                    ╷                                    │
│     │              ┃                     │   ← 細線十字光標（灰色）           │
│  520┤─ ─ ─ ─ ─ ─ ─┃─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─   ← 水平十字線             │
│     │   ║ ║   ║    ┃   ║        ║       │                                    │
│  515┤   ▓ ▓   ▓    ┃   ▓        ▓       │                                    │
│     │   ▓ ▓   ▓    ┃   ▓ ║ ║    ▓       │                                    │
│  510┤   ▓ ▓   ▓    ┃   ▓ ▓ ▓    ▓       ╵                                    │
│     │       ▓       ┃     ▓                                                   │
│  505┤       ▓       ┃     ▓                                                   │
│     └───────────────┸──────────────────────────────────────────────────────  │
│           10:00   11:00   12:00   13:00   14:00   15:00                      │
│                                                                               │
│  圖例：                                                                       │
│  ║ ║  = 上漲蠟燭（青綠色 #26a69a）                                            │
│  ▓ ▓  = 上漲蠟燭實體                                                          │
│  ║ ║  = 下跌蠟燭（珊瑚紅 #ef5350）                                            │
│  ▓ ▓  = 下跌蠟燭實體                                                          │
│  ─ ─  = 虛線網格（淡藍灰色 #F0F3FA）                                          │
│  ┃    = 垂直十字光標                                                          │
│  ─ ┼ ─= 水平十字光標                                                          │
└──────────────────────────────────────────────────────────────────────────────┘


╔════════════════════════════════════════════════════════════════════════════════╗
║                            功能說明與使用方法                                   ║
╚════════════════════════════════════════════════════════════════════════════════╝

【OHLC 信息面板】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 1. 位置：左上角浮動顯示                                                      │
│ 2. 內容：                                                                    │
│    • 第一行：時間 + 漲跌額 + 漲跌幅（根據漲跌顯示顏色）                      │
│    • 第二行：O(開盤) H(最高) L(最低) C(收盤)                                 │
│ 3. 顏色：                                                                    │
│    • 上漲：青綠色 #26a69a                                                    │
│    • 下跌：珊瑚紅 #ef5350                                                    │
│ 4. 更新時機：                                                                │
│    • 鼠標移動到 K 線圖上時 → 顯示鼠標位置的 K 線數據                         │
│    • 無鼠標移動時 → 顯示最新的 K 線數據                                      │
│    • 每次價格更新時 → 自動刷新                                               │
└─────────────────────────────────────────────────────────────────────────────┘

【十字光標】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 1. 樣式：細線（1.0f 線寬）、半透明灰色                                       │
│ 2. 功能：                                                                    │
│    • 鼠標移動時自動顯示                                                      │
│    • 垂直線顯示時間位置                                                      │
│    • 水平線顯示價格位置                                                      │
│    • 與 OHLC 面板聯動，精確對齊 K 線數據                                     │
└─────────────────────────────────────────────────────────────────────────────┘

【網格線】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 1. 顏色：淡藍灰色 #F0F3FA（非常淡，不刺眼）                                  │
│ 2. 樣式：虛線（2px 實線 + 2px 間隔）                                         │
│ 3. 效果：提供清晰的價格和時間參考，但不會干擾數據觀察                        │
└─────────────────────────────────────────────────────────────────────────────┘

【蠟燭配色】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 採用 TradingView 現代配色方案：                                              │
│ • 上漲（收盤 ≥ 開盤）：青綠色 #26a69a (RGB: 38, 166, 154)                   │
│ • 下跌（收盤 < 開盤）：珊瑚紅 #ef5350 (RGB: 239, 83, 80)                    │
│                                                                              │
│ 優點：                                                                       │
│ • 現代化、專業                                                               │
│ • 顏色對比明顯但不刺眼                                                       │
│ • 符合國際主流交易軟件習慣                                                   │
└─────────────────────────────────────────────────────────────────────────────┘


╔════════════════════════════════════════════════════════════════════════════════╗
║                              實際使用場景示例                                   ║
╚════════════════════════════════════════════════════════════════════════════════╝

【場景 1：查看最新 K 線】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 當價格更新時，OHLC 面板自動顯示最新 K 線：                                   │
│                                                                              │
│ ┌──────────────────────────────┐                                            │
│ │ 15:42:30  +3.50 (+0.68%)     │  ← 實時更新                                │
│ │ O: 515.00  H: 520.50         │                                            │
│ │ L: 514.20  C: 518.50         │                                            │
│ └──────────────────────────────┘                                            │
│                                                                              │
│ 用戶無需任何操作，面板自動刷新                                               │
└─────────────────────────────────────────────────────────────────────────────┘

【場景 2：查看歷史 K 線】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 鼠標移動到歷史 K 線上時：                                                    │
│                                                                              │
│ 1. 十字光標自動對齊到最近的 K 線                                             │
│ 2. OHLC 面板顯示該 K 線的完整數據                                            │
│ 3. 狀態欄同時顯示當前價格和量尺信息                                          │
│                                                                              │
│ ┌──────────────────────────────┐                                            │
│ │ 12:15:00  -2.00 (-0.39%)     │  ← 顯示歷史數據                            │
│ │ O: 512.00  H: 513.50         │                                            │
│ │ L: 509.00  C: 510.00         │                                            │
│ └──────────────────────────────┘                                            │
└─────────────────────────────────────────────────────────────────────────────┘

【場景 3：多週期切換】
┌─────────────────────────────────────────────────────────────────────────────┐
│ 切換不同時間週期（10秒、30秒、1分、5分等）時：                               │
│                                                                              │
│ • OHLC 面板自動適應當前週期                                                  │
│ • 顯示對應週期的 K 線數據                                                    │
│ • 時間格式自動調整                                                           │
│                                                                              │
│ 例如切換到 10 秒週期：                                                       │
│ ┌──────────────────────────────┐                                            │
│ │ 15:42:30  +0.50 (+0.10%)     │  ← 10 秒 K 線                              │
│ │ O: 515.00  H: 515.80         │                                            │
│ │ L: 514.90  C: 515.50         │                                            │
│ └──────────────────────────────┘                                            │
└─────────────────────────────────────────────────────────────────────────────┘


╔════════════════════════════════════════════════════════════════════════════════╗
║                            與 TradingView 的對比                               ║
╚════════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────┬─────────────────────┬─────────────────────────────┐
│          功能            │    TradingView      │       本系統（改進後）       │
├──────────────────────────┼─────────────────────┼─────────────────────────────┤
│ OHLC 信息面板            │         ✅          │           ✅                │
│ 左上角浮動顯示           │         ✅          │           ✅                │
│ 實時更新                 │         ✅          │           ✅                │
│ 顏色根據漲跌變化         │         ✅          │           ✅                │
│ 細線十字光標             │         ✅          │           ✅                │
│ 淡色虛線網格             │         ✅          │           ✅                │
│ 現代化配色方案           │         ✅          │           ✅                │
│ 鼠標懸停聯動             │         ✅          │           ✅                │
│ 多週期支持               │         ✅          │           ✅                │
│ 縮放和平移               │         ✅          │           ✅                │
├──────────────────────────┼─────────────────────┼─────────────────────────────┤
│ 畫線工具                 │         ✅          │       ⏳ (計劃中)           │
│ 更多技術指標顯示         │         ✅          │       ⏳ (計劃中)           │
│ 可調整面板位置           │         ✅          │       ⏳ (計劃中)           │
│ 自定義配色               │         ✅          │       ⏳ (計劃中)           │
└──────────────────────────┴─────────────────────┴─────────────────────────────┘

說明：
✅ = 已實現
⏳ = 計劃實現
❌ = 未實現


╔════════════════════════════════════════════════════════════════════════════════╗
║                              技術實現細節                                       ║
╚════════════════════════════════════════════════════════════════════════════════╝

【OHLC 面板實現】
• 使用 JLabel 組件 + HTML 格式化
• 使用 JLayeredPane 實現圖表疊加
• 面板層級：JLayeredPane.PALETTE_LAYER（確保在圖表之上）
• 背景：半透明白色 (255, 255, 255, 230)
• 邊框：1px 淺灰色邊框 + 內邊距

【數據查找算法】
• 鼠標移動時，使用線性搜索找到最接近的 K 線
• 時間複雜度：O(n)，其中 n 是當前顯示的 K 線數量
• 優化：由於 K 線數量通常不多（< 100），性能影響可忽略
• 未來優化：可使用二分查找降至 O(log n)

【顏色方案】
上漲：#26a69a (38, 166, 154)  HSL(176°, 62%, 40%)
下跌：#ef5350 (239, 83, 80)   HSL(1°, 83%, 63%)

【性能優化】
• OHLC 面板更新不觸發整個圖表重繪
• 使用 SwingUtilities.invokeLater 確保線程安全
• 異常捕獲避免崩潰


╔════════════════════════════════════════════════════════════════════════════════╗
║                                  總結                                          ║
╚════════════════════════════════════════════════════════════════════════════════╝

通過實現 TradingView 風格的改進，K 線圖現在具備：

1. ✨ 專業的視覺設計
2. 📊 完整的 OHLC 信息顯示
3. 🎯 精確的十字光標定位
4. 🎨 現代化的配色方案
5. ⚡ 流暢的交互體驗
6. 🔄 實時的數據更新

這些改進使得系統更加接近專業交易軟件的水準，提升了用戶體驗和可用性。

