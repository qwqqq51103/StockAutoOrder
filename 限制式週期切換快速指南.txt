╔══════════════════════════════════════════════════════════════════════════════╗
║                       限制式K線週期切換功能 - 快速指南                        ║
╚══════════════════════════════════════════════════════════════════════════════╝

📅 實作時間：2025-10-23
🎯 方案：方案3（限制式切換 - 折衷方案）

┌──────────────────────────────────────────────────────────────────────────────┐
│  🎨 UI 控件                                                                  │
└──────────────────────────────────────────────────────────────────────────────┘

在工具列上可以看到：

    ┌─────────────────────────────┐
    │ K線週期: [◀] [10秒] [▶]   │
    └─────────────────────────────┘
                ↑    ↑     ↑
               上一  當前  下一
               週期  週期  週期

┌──────────────────────────────────────────────────────────────────────────────┐
│  🔄 週期切換鏈                                                               │
└──────────────────────────────────────────────────────────────────────────────┘

    10秒 ↔ 30秒 ↔ 1分 ↔ 5分 ↔ 10分 ↔ 30分 ↔ 60分
     ↑                                         ↑
   最小                                      最大

    ✓ 只能在相鄰週期之間切換
    ✓ 所有相鄰週期都是整數倍關係
    ✓ 自動聚合K線數據
    ✓ 自動對齊信號標記

┌──────────────────────────────────────────────────────────────────────────────┐
│  📖 倍數關係表                                                               │
└──────────────────────────────────────────────────────────────────────────────┘

    從      到      倍數    計算
    ───────────────────────────────
    10秒 →  30秒    3倍     30÷10=3
    30秒 →  1分     2倍     60÷30=2
    1分  →  5分     5倍     5÷1=5
    5分  →  10分    2倍     10÷5=2
    10分 →  30分    3倍     30÷10=3
    30分 →  60分    2倍     60÷30=2

┌──────────────────────────────────────────────────────────────────────────────┐
│  🎯 使用方法                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

【放大週期 - 點擊 ▶】

    1. 點擊 ▶ 按鈕
    2. 系統自動聚合K線數據
    3. 歷史完整保留
    4. 信號標記自動對齊

    範例：10秒 → 30秒
    
    ┌────┬────┬────┐        ┌──────────┐
    │K1  │K2  │K3  │   →    │ 新K1     │
    │10秒│10秒│10秒│  聚合  │ 30秒     │
    └────┴────┴────┘        └──────────┘


【縮小週期 - 點擊 ◀】

    1. 點擊 ◀ 按鈕
    2. 切換到更小週期
    3. 使用該週期已累積的數據
    4. 可能數據較少（需要等待累積）

┌──────────────────────────────────────────────────────────────────────────────┐
│  💡 使用場景                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

╔═══════════════════════════════════════════════════════════════════════════╗
║  📈 短線交易者                                                             ║
╚═══════════════════════════════════════════════════════════════════════════╝

    開盤：10秒週期（觀察tick級別變化）
      ↓ 點擊 ▶
    盤中：30秒-1分鐘（短線操作）
      ↓ 點擊 ▶
    確認：5分鐘（確認趨勢）

╔═══════════════════════════════════════════════════════════════════════════╗
║  📊 波段交易者                                                             ║
╚═══════════════════════════════════════════════════════════════════════════╝

    選股：60分鐘（大趨勢）
      ↓ 點擊 ◀
    入場：10分鐘（找支撐壓力）
      ↓ 點擊 ◀
    出場：5分鐘（確認信號）

╔═══════════════════════════════════════════════════════════════════════════╗
║  ⚡ 當沖交易者                                                             ║
╚═══════════════════════════════════════════════════════════════════════════╝

    基本：10秒-30秒（主要週期）
      ↓ 點擊 ▶（偶爾）
    確認：1分鐘（確認大方向）
      ↓ 點擊 ◀（快速返回）
    執行：10秒-30秒（精準出入場）

┌──────────────────────────────────────────────────────────────────────────────┐
│  ⚠️ 注意事項                                                                │
└──────────────────────────────────────────────────────────────────────────────┘

    ✓ 放大週期（▶）
      • 自動聚合，保留完整歷史
      • K線數據完整
      • 視覺連續

    ⚠ 縮小週期（◀）
      • 取決於該週期已累積的數據量
      • 如果剛切換，可能只有1-2根K線
      • 需要等待累積更多數據

    ⚠ 信號標記對齊
      • 自動對齊到K線起始時間
      • 自動去重（同一時間桶只保留一個標記）
      • 可能造成標記數量減少

┌──────────────────────────────────────────────────────────────────────────────┐
│  📝 訊息提示                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

    類型            訊息範例
    ───────────────────────────────────────────────────────────────
    開始切換        "正在從 30秒 切換到 1分..."
    聚合進度        "已聚合 15 根小週期K線 -> 5 根大週期K線"
    成功完成        "✓ 已切換到 1分 週期"
    已達最小        "已經是最小週期（10秒）"
    已達最大        "已經是最大週期（60分）"
    錯誤            "切換週期失敗: [錯誤訊息]"

┌──────────────────────────────────────────────────────────────────────────────┐
│  ✅ 優點                                                                     │
└──────────────────────────────────────────────────────────────────────────────┘

    ✓ 保留歷史數據（放大時自動聚合）
    ✓ 信號對齊正確（自動對齊到K線時間桶）
    ✓ 操作簡單（只有兩個按鈕）
    ✓ 系統穩定（只允許有倍數關係的切換）
    ✓ 實用性高（覆蓋常用交易週期）

┌──────────────────────────────────────────────────────────────────────────────┐
│  ⚠️ 限制                                                                    │
└──────────────────────────────────────────────────────────────────────────────┘

    ❌ 不能跳躍切換（需要逐級切換）
    ⚠️ 縮小週期時數據可能不足
    ⚠️ 信號標記可能減少（對齊+去重）
    ⚠️ 聚合大量K線需要時間（但通常<1秒）

┌──────────────────────────────────────────────────────────────────────────────┐
│  🔧 技術實作                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

    檔案：MainView.java

    關鍵方法：
    • switchToPeriod()           - 主切換邏輯
    • aggregatePeriodData()      - K線聚合
    • updateChartDataset()       - 更新圖表
    • realignSignalMarkers()     - 對齊信號

    資料結構：
    • periodChain[]              - 週期切換鏈
    • periodNames[]              - 週期顯示名稱
    • currentPeriodIndex         - 當前位置

┌──────────────────────────────────────────────────────────────────────────────┐
│  📚 詳細文檔                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

    完整說明：限制式K線週期切換功能.md
    技術細節：程式碼中有詳細註解

┌──────────────────────────────────────────────────────────────────────────────┐
│  🎉 開始使用                                                                 │
└──────────────────────────────────────────────────────────────────────────────┘

    1. 重新編譯程式
    2. 啟動應用程式
    3. 在工具列找到「K線週期」控件
    4. 點擊 ◀ 或 ▶ 切換週期
    5. 觀察訊息區的切換提示

════════════════════════════════════════════════════════════════════════════════

版本：1.0
更新：2025-10-23
狀態：✅ 已完成並可用

